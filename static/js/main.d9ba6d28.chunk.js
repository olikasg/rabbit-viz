(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{208:function(e,t,n){e.exports=n.p+"static/media/logo.3938d65c.svg"},220:function(e,t,n){e.exports=n(422)},421:function(e,t,n){},422:function(e,t,n){"use strict";n.r(t);var i=n(1),o=n(59),r=(n(225),n(226),n(428)),a=n(433),c=n(432),s=n(194),u=n(19),l=n(38),d=n(210),f=n(135),h=n(127),m={height:30,width:180};function g(e){var t=h.cloneDeep(e);return function(e){var t=function(e){return e.nodes.map(function(e){return{id:e.id,metadata:Object(d.a)({},m,{id:e.id})}})}(e),n=function(e){return e.links.map(function(e){return{from:e.source,to:e.target}}).filter(function(t){return e.nodes.find(function(e){return e.id===t.from})&&e.nodes.find(function(e){return e.id===t.to})})}(e),i=new f.graphlib.Graph;return i.setGraph({rankdir:"LR",ranksep:100}),i.setDefaultEdgeLabel(function(){return{}}),t.forEach(function(e){i.setNode(e.id,e.metadata)}),n.forEach(function(e){e.from&&e.to&&i.setEdge(e.from,e.to)}),f.layout(i),i.nodes().map(function(e){return i.node(e)})}(t).forEach(function(e){var n=t.nodes.find(function(t){return t.id===e.id});n.x=e.x,n.y=e.y}),t}var v="rgb(0,192,255)",p="rgb(192,255,0)",b={definition:{bindings:[],exchanges:[],parameters:[],policies:[],queues:[],vhosts:[]},isValid:!0,validate:function(e,t,n){return null}};function E(){return Object(u.a)(b,function(e){e.isValid=!0})}function w(e,t,n){var i=[],o=[],r=[],a=new l.DiagramModel,c=e.bindings.filter(function(e){return"All"===t.currentVhost||e.vhost===t.currentVhost});(c.length>0?function(e){var t=[];return e.forEach(function(e){var n=t.findIndex(function(t){return t.vhost===e.vhost&&t.source===e.source&&t.destination===e.destination&&t.destinationType===e.destination_type});-1===n?t.push({destination:e.destination,destinationType:e.destination_type,routingKeys:""===e.routing_key?[]:[e.routing_key],source:e.source,vhost:e.vhost}):""!==e.routing_key&&t[n].routingKeys.push(e.routing_key)}),t}(c):[]).forEach(function(e){var n,a,c=e.vhost,s="Exchange: ".concat(e.source," ").concat("All"===t.currentVhost?"(".concat(c,")"):""),u=i.find(function(e){return e.name===s});void 0===u&&(u=y(s,v),i.push(u)),"queue"===e.destinationType?(a="Queue: ".concat(e.destination," ").concat("All"===t.currentVhost?"(".concat(c,")"):""),void 0===(n=o.find(function(e){return e.name===a}))&&(n=y(a,p),o.push(n))):(a="Exchange: ".concat(e.destination," ").concat("All"===t.currentVhost?"(".concat(c,")"):""),void 0===(n=i.find(function(e){return e.name===a}))&&(n=y(a,v),i.push(n)));var l=u.getOutPorts().length>0?u.getOutPorts()[0]:u.addOutPort("Out"),d=n.getInPorts().length>0?n.getInPorts()[0]:n.addInPort("In"),f=l.createLinkModel();f.setSourcePort(l),f.setTargetPort(d),t.showRoutingKeys&&e.routingKeys.forEach(function(e){return f.addLabel(e)}),r.push(f)});var s=1,u=1;return i.forEach(function(e){e.getInPorts().length>0&&e.getOutPorts().length>0?(e.x=300,e.y=70*u,u++):(e.x=70,e.y=70*s,s++),a.addNode(e)}),o.forEach(function(e,t){e.x=530,e.y=70*(t+1),a.addNode(e)}),r.forEach(function(e){a.addLink(e)}),function(e,t){var n=g(t.serializeDiagram()),i=new l.DiagramModel;return i.deSerializeDiagram(n,e),i}(n,a)}function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"rgb(0,192,255)";return new l.DefaultNodeModel(e,t)}var O={currentVhost:"",errors:[],selectVhost:function(e,t){return null},setZoomFunction:function(){return null},showRoutingKeys:!1,toggleShowRoutingKeys:function(){return null},zoomToFit:function(){return null}};function k(){return Object(u.a)(O,function(e){e.currentVhost="All"})}var j=i.createContext(E()),S=i.createContext(k());n(381);var D=function(){return i.createElement(j.Consumer,null,function(e){return i.createElement(s.UnControlled,{value:'{\n  "vhosts": [],\n  "parameters": [],\n  "policies": [],\n  "queues": [],\n  "exchanges": [],\n  "bindings": []\n}',options:{lineNumbers:!0,mode:"javascript",theme:"material"},onChange:e.validate})})},x=n(60),V=n(61),C=n(63),z=n(62),R=n(64),F=n(430),I=(n(382),function(e){function t(e){var n;return Object(x.a)(this,t),(n=Object(C.a)(this,Object(z.a)(t).call(this,e))).engine=void 0,n.zoomFunctionSet=void 0,n.engine=new l.DiagramEngine,n.engine.installDefaultFactories(),n.zoomFunctionSet=!1,n}return Object(R.a)(t,e),Object(V.a)(t,[{key:"render",value:function(){var e=this;return i.createElement(S.Consumer,null,function(t){return i.createElement(j.Consumer,null,function(n){return n.definition.vhosts.length>0?e.renderDefinitionDiagram(n,t):e.renderMessageBox(t)})})}},{key:"renderMessageBox",value:function(e){return(new l.DiagramEngine).installDefaultFactories(),e.errors.length>0?i.createElement(F.a,{error:!0,header:"Invalid broker definition json",list:e.errors,attached:"top",icon:"exclamation circle"}):i.createElement(F.a,{content:"Please load a broker definition using the editor panel.",header:"No Broker Definition Present",info:!0,attached:"top",icon:"info circle"})}},{key:"renderDefinitionDiagram",value:function(e,t){var n=this,o=w(e.definition,t,this.engine);return this.engine.setDiagramModel(o),this.zoomFunctionSet||(t.setZoomFunction(function(){n.engine.zoomToFit()}),this.zoomFunctionSet=!0),i.createElement(l.DiagramWidget,{className:"srd-canvas",diagramEngine:this.engine,inverseZoom:!0})}}]),t}(i.Component)),P=n(434),K=n(431),T=n(429);var N=function(){return i.createElement(S.Consumer,null,function(e){return i.createElement(j.Consumer,null,function(t){return t.definition.vhosts.length>0?i.createElement(c.a,{attached:"top"},function(e,t,n){var o=function(e){var t=[{key:"All",value:"All",text:"All"}];return e.forEach(function(e){return t.push({key:e.name,value:e.name,text:e.name})}),t}(e);return i.createElement(c.a.Item,null,"Virtual Host:\xa0",i.createElement(T.a,{placeholder:"Virtual Hosts",value:t,selection:!0,options:o,onChange:n}))}(t.definition.vhosts,e.currentVhost,e.selectVhost),i.createElement(c.a.Item,null,i.createElement(P.a,{toggle:!0,label:"Show Routing Keys",onChange:e.toggleShowRoutingKeys,checked:e.showRoutingKeys})),i.createElement(c.a.Item,null,i.createElement(K.a,{onClick:e.zoomToFit,content:"Zoom to Fit"}))):""})})},A=n(209),B=n(65),L=n(208),M=n.n(L),_=function(e){function t(){return Object(x.a)(this,t),Object(C.a)(this,Object(z.a)(t).apply(this,arguments))}return Object(R.a)(t,e),Object(V.a)(t,[{key:"render",value:function(){return i.createElement(c.a,{fixed:"top",inverted:!0},i.createElement(r.a,{fluid:!0},i.createElement(c.a.Item,{header:!0,as:"h4"},i.createElement(A.a,{size:"mini",src:M.a,style:{marginRight:"1.5em"}}),"Rabbit Viz"),i.createElement(c.a.Item,{position:"right",href:"https://github.com/plexsystems/rabbit-viz",target:"_blank"},i.createElement(B.a,{name:"github",size:"big"}),"Fork us on GitHub!")))}}]),t}(i.Component),W=n(72),q=function(e){function t(e){var n;return Object(x.a)(this,t),(n=Object(C.a)(this,Object(z.a)(t).call(this,e))).state={clusterDefinition:Object(u.a)(E(),function(e){e.validate=n.validateDefinitionsJson.bind(Object(W.a)(Object(W.a)(n)))}),viewState:Object(u.a)(k(),function(e){e.selectVhost=function(e,t){n.setState(Object(u.a)(function(e){e.viewState.currentVhost=t.value}))},e.setZoomFunction=function(e){n.setState(Object(u.a)(function(t){t.viewState.zoomToFit=e}))},e.toggleShowRoutingKeys=function(){n.setState(Object(u.a)(function(e){e.viewState.showRoutingKeys=!e.viewState.showRoutingKeys}))}})},n}return Object(R.a)(t,e),Object(V.a)(t,[{key:"render",value:function(){return i.createElement(S.Provider,{value:this.state.viewState},i.createElement(j.Provider,{value:this.state.clusterDefinition},this.props.children))}},{key:"validateDefinitionsJson",value:function(e,t,n){if(n.length>0)try{var i=JSON.parse(n);i.vhosts=i.vhosts.sort(function(e,t){return e.name>t.name?1:e.name<t.name?-1:0}),this.setState(Object(u.a)(function(e){e.clusterDefinition.isValid=!0,e.viewState.errors=[],e.clusterDefinition.definition=i}))}catch(o){return void this.setState(Object(u.a)(function(e){e.clusterDefinition.isValid=!1,e.viewState.errors=[o.message],e.clusterDefinition.definition={bindings:[],exchanges:[],parameters:[],policies:[],queues:[],vhosts:[]}}))}else this.setState(Object(u.a)(function(e){e.clusterDefinition.isValid=!0,e.viewState.errors=[],e.clusterDefinition.definition={bindings:[],exchanges:[],parameters:[],policies:[],queues:[],vhosts:[]}}))}}]),t}(i.Component),J=function(){return i.createElement(q,null,i.createElement(_,null),i.createElement(r.a,{fluid:!0},i.createElement(a.a,{style:{height:"100vh"},centered:!0,celled:"internally"},i.createElement(a.a.Row,{style:{height:"100%"}},i.createElement(a.a.Column,{width:12,style:{padding:0,marginTop:"4.5em",marginBottom:"2.5em"},className:"srd-container"},i.createElement(N,null),i.createElement(I,null)),i.createElement(a.a.Column,{width:4,style:{padding:0,marginTop:"4.5em",marginBottom:"2.5em"}},i.createElement(D,null))))),i.createElement(c.a,{fixed:"bottom",inverted:!0},i.createElement(c.a.Item,{header:!0,position:"right"},"\xa9 2019 Plex Systems, Inc. All Rights Reserved.")))},Z=(n(421),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function G(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}o.render(i.createElement(J,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/rabbit-viz",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/rabbit-viz","/service-worker.js");Z?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):G(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):G(e)})}}()}},[[220,1,2]]]);
//# sourceMappingURL=main.d9ba6d28.chunk.js.map